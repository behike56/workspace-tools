#:kivy 2.3.0

<SelectableLabel>:
    size_hint_y: None
    height: "40dp"
    padding: 12, 0
    canvas.before:
        Color:
            rgba: (0.2, 0.5, 0.9, 0.25) if self.selected else (0, 0, 0, 0)
        Rectangle:
            pos: self.pos
            size: self.size

<Root>:
    orientation: "vertical"
    padding: 12
    spacing: 10

    # ===== 検索バー =====
    BoxLayout:
        size_hint_y: None
        height: "42dp"
        spacing: 8
        TextInput:
            id: q
            hint_text: "検索（例: fruit  or  vege  など）"
            text: root.query
            multiline: False
            on_text: root.query = self.text  # 双方向バインド
        Button:
            text: "クリア"
            on_release: root.clear_query()
        Button:
            text: "ソート切替"
            on_release: root.toggle_sort()

    # ===== 一覧（RecycleView）=====
    RecycleView:
        id: rv
        viewclass: "SelectableLabel"
        scroll_type: ["bars", "content"]
        bar_width: "6dp"
        effect_cls: "ScrollEffect"

        SelectableRecycleBoxLayout:
            id: layout
            default_size: None, dp(40)
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: "vertical"
            multiselect: False
            touch_multiselect: False

    # ===== ステータス =====
    Label:
        size_hint_y: None
        height: "28dp"
        text: root.status
        halign: "left"
        valign: "middle"
        text_size: self.size
